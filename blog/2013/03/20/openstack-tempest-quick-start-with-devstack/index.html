<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>OpenStack Tempest quick start with DevStack</title>
  <meta name="author" content="Rushi Agrawal">

  <link href="http://rushiagr.github.io/feeds/all.rss.xml" type="application/rss+xml" rel="alternate"
        title="Sense, and Simplicity RSS Feed" />


  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="/favicon.png" rel="icon">
  <link href="/theme/css/main.css" media="screen, projection"
        rel="stylesheet" type="text/css">
  <script src="/theme/js/modernizr-2.0.js"></script>
  <script src="/theme/js/ender.js"></script>
  <script src="/theme/js/octopress.js" type="text/javascript"></script>

  <link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
  <link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
</head>

<body>
  <header role="banner"><hgroup>
  <h1><a href="/">Sense, and Simplicity</a></h1>
</hgroup></header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://rushiagr.github.io/feeds/all.rss.xml" rel="subscribe-rss">RSS</a></li>
</ul>



<ul class="main-navigation">
      <li><a href="/pages/about-me.html">About me</a></li>
    <li class="active">
    <a href="/category/tech.html">Tech</a>
    </li>
    <li >
    <a href="/category/thoughts.html">Thoughts</a>
    </li>
</ul></nav>
  <div id="main">
    <div id="content">
<div>
  <article class="hentry" role="article">
<header>
      <h1 class="entry-title">OpenStack Tempest quick start with DevStack</h1>
      <p class="meta"><time datetime="2013-03-20T00:00:00" pubdate>Wed 20 March 2013</time></p>
</header>

  <div class="entry-content"><p>UPDATE(April 2014): Now when you set up DevStack, Tempest is automatically set up for you.</p>
<p>This quick start guide explains setting up Tempest with a DevStack environment
for Grizzly release. Most of the information here is taken from
<a href="http://www.joinfu.com/2012/03/testing-essex-rc1-with-devstack-and-tempest/">here</a>, the only difference being this blog post is more recent, and is based on Grizzly.</p>
<!--more-->

<p>Assumptions made are that you understand:
1. What is a <code>localrc</code> file in DevStack.
2. What does <code>./stack.sh</code> do in DevStack.
3. How to clone using git.</p>
<h2>Setting up DevStack</h2>
<p>Clone DevStack</p>
<div class="highlight"><pre><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="o">:</span><span class="c1">//github.com/openstack-dev/devstack.git</span>
<span class="n">cd</span> <span class="n">devstack</span>
</pre></div>


<p>Tempest requires that the rate-limiting for DevStack is turned off. By default, it is turned on, so turn it off by adding this line to the localrc file.</p>
<div class="highlight"><pre><span class="n">API_RATE_LIMIT</span><span class="o">=</span><span class="n">False</span>
</pre></div>


<p>If you have already created a DevStack environment, you will have to go through the labour of setting it all again by unstacking and restacking it with this parameter in localrc.
Quick tip: If you already had a working DevStack in your computer, adding <code>OFFLINE=True</code> line in localrc will create the DevStack environment in your computer WITHOUT
downloading all the OpenStack code all over again from the Github repos, but will build the environment from the existing code (thus saving you some Internet bandwidth and time).</p>
<p>Build the DevStack environment</p>
<div class="highlight"><pre><span class="p">.</span><span class="o">/</span><span class="n">stack</span><span class="p">.</span><span class="n">sh</span>
</pre></div>


<p>Supply all the five passwords. (If you are just playing around, just like me, then
you can easily supply <code>nova</code> to all the passwords.)</p>
<p>Note the IP of the system where DevStack is running (The 'host IP' mentioned at the last of the output after running <code>stack.sh</code>).</p>
<h2>Setting up Tempest</h2>
<p>Clone latest Tempest code</p>
<div class="highlight"><pre><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="o">:</span><span class="c1">//github.com/openstack/tempest.git</span>
<span class="n">cd</span> <span class="n">tempest</span>
</pre></div>


<p>Create tempest.conf file from the sample configuration file. This file will contain the configuration information of the OpenStack environment (here, the DevStack
environment)</p>
<div class="highlight"><pre><span class="n">cp</span> <span class="n">etc</span><span class="o">/</span><span class="n">tempest</span><span class="p">.</span><span class="n">conf</span><span class="p">.</span><span class="n">sample</span> <span class="n">etc</span><span class="o">/</span><span class="n">tempest</span><span class="p">.</span><span class="n">conf</span>
</pre></div>


<p>Now open the file tempest.conf in an editor, and replace all instance of word <code>secret</code> with the appropriate password (<code>nova</code> if you followed me, and just typed <code>nova</code> whenever the
<code>stack.sh</code> script asked for passwords)</p>
<p>If, for example, your host IP is 10.0.24.30, change this line in tempest.conf </p>
<div class="highlight"><pre><span class="n">uri</span> <span class="o">=</span> <span class="n">http</span><span class="o">:</span><span class="c1">//127.0.0.1:5000/v2.0/</span>
</pre></div>


<p>to make it</p>
<div class="highlight"><pre><span class="n">uri</span> <span class="o">=</span> <span class="n">http</span><span class="o">:</span><span class="c1">//10.0.24.30:5000/v2.0/</span>
</pre></div>


<p>The last thing to update in the tempest.conf file is the ID of the Cirros image. The image ID can be obtained by two ways</p>
<h4>Image ID using glance</h4>
<p>This command will return the image ID. Note that I have used the password <code>nova</code> in this line. You might also need to change the host IP address</p>
<div class="highlight"><pre><span class="n">glance</span> <span class="o">-</span><span class="n">I</span> <span class="n">admin</span> <span class="o">-</span><span class="n">K</span> <span class="n">nova</span> <span class="o">-</span><span class="n">T</span> <span class="n">admin</span> <span class="o">-</span><span class="n">N</span> <span class="n">http</span><span class="o">:</span><span class="c1">//10.0.24.30:5000/v2.0 -S keystone index | grep ami | cut -f1 | awk &#39;{print $1}&#39;</span>
</pre></div>


<h4>Image ID using OpenStack CLI</h4>
<p>Become stack user</p>
<div class="highlight"><pre><span class="n">su</span> <span class="o">-</span> <span class="n">stack</span>
</pre></div>


<p>Source the sample credentials file</p>
<div class="highlight"><pre><span class="p">.</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">stack</span><span class="o">/</span><span class="n">devstack</span><span class="o">/</span><span class="n">eucarc</span>
</pre></div>


<p>OR</p>
<div class="highlight"><pre><span class="p">.</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">stack</span><span class="o">/</span><span class="n">devstack</span><span class="o">/</span><span class="n">openrc</span>
</pre></div>


<p>Show all the images, with their IDs</p>
<div class="highlight"><pre><span class="err">$</span> <span class="n">nova</span> <span class="n">image</span><span class="o">-</span><span class="n">list</span>
<span class="o">+--------------------------------------+---------------------------------+--------+--------+</span>
<span class="o">|</span> <span class="n">ID</span>                                   <span class="o">|</span> <span class="n">Name</span>                            <span class="o">|</span> <span class="n">Status</span> <span class="o">|</span> <span class="n">Server</span> <span class="o">|</span>
<span class="o">+--------------------------------------+---------------------------------+--------+--------+</span>
<span class="o">|</span> <span class="mi">13</span><span class="n">abf9c8</span><span class="o">-</span><span class="mi">5603</span><span class="o">-</span><span class="mi">48</span><span class="n">cb</span><span class="o">-</span><span class="mi">802</span><span class="n">e</span><span class="o">-</span><span class="n">e27162e10b58</span> <span class="o">|</span> <span class="n">cirros</span><span class="o">-</span><span class="mf">0.3.0</span><span class="o">-</span><span class="n">x86_64</span><span class="o">-</span><span class="n">uec</span>         <span class="o">|</span> <span class="n">ACTIVE</span> <span class="o">|</span>        <span class="o">|</span>
<span class="o">|</span> <span class="mi">39</span><span class="n">b023ae</span><span class="o">-</span><span class="mi">9201</span><span class="o">-</span><span class="mi">427</span><span class="n">d</span><span class="o">-</span><span class="mi">8350</span><span class="o">-</span><span class="mf">4f30e5</span><span class="n">bbc01a</span> <span class="o">|</span> <span class="n">cirros</span><span class="o">-</span><span class="mf">0.3.0</span><span class="o">-</span><span class="n">x86_64</span><span class="o">-</span><span class="n">uec</span><span class="o">-</span><span class="n">kernel</span>  <span class="o">|</span> <span class="n">ACTIVE</span> <span class="o">|</span>        <span class="o">|</span>
<span class="o">|</span> <span class="mi">431</span><span class="n">a9c04</span><span class="o">-</span><span class="mi">47</span><span class="n">b1</span><span class="o">-</span><span class="mf">47e4</span><span class="o">-</span><span class="mi">9521</span><span class="o">-</span><span class="mf">7f</span><span class="mi">12295</span><span class="n">c78e0</span> <span class="o">|</span> <span class="n">cirros</span><span class="o">-</span><span class="mf">0.3.0</span><span class="o">-</span><span class="n">x86_64</span><span class="o">-</span><span class="n">uec</span><span class="o">-</span><span class="n">ramdisk</span> <span class="o">|</span> <span class="n">ACTIVE</span> <span class="o">|</span>        <span class="o">|</span>
<span class="o">+--------------------------------------+---------------------------------+--------+--------+</span>
</pre></div>


<p>The ID of the smallest image name is what we're interested in.</p>
<p>Now replace <code>{$IMAGE_ID}</code> and <code>{$IMAGE_ID_ALT}</code> with this value, to make those two lines appear in tempest.conf as</p>
<div class="highlight"><pre><span class="n">image_ref</span> <span class="o">=</span> <span class="mi">13</span><span class="n">abf9c8</span><span class="o">-</span><span class="mi">5603</span><span class="o">-</span><span class="mi">48</span><span class="n">cb</span><span class="o">-</span><span class="mi">802</span><span class="n">e</span><span class="o">-</span><span class="n">e27162e10b58</span>
<span class="n">image_ref_alt</span> <span class="o">=</span> <span class="mi">13</span><span class="n">abf9c8</span><span class="o">-</span><span class="mi">5603</span><span class="o">-</span><span class="mi">48</span><span class="n">cb</span><span class="o">-</span><span class="mi">802</span><span class="n">e</span><span class="o">-</span><span class="n">e27162e10b58</span>
</pre></div>


<h2>Installing required dependencies</h2>
<p>Install all the required packages needed to run Tempest integration test suite. (The list of required packages is maintained in file <code>tools/pip-requires</code>)</p>
<div class="highlight"><pre><span class="err">$</span> <span class="n">sudo</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">r</span> <span class="n">tools</span><span class="o">/</span><span class="n">pip</span><span class="o">-</span><span class="n">requires</span>
</pre></div>


<h2>Show time!</h2>
<p>We'll run all the tests in verbose mode. To run all the tests:</p>
<div class="highlight"><pre><span class="n">nosetests</span> <span class="o">-</span><span class="n">v</span> <span class="n">tempest</span>
</pre></div>


<p>To run tests only from a specific file, say <code>tempest/tests/volume/test_volumes_list.py</code>:</p>
<div class="highlight"><pre><span class="n">nosetests</span> <span class="o">-</span><span class="n">sv</span> <span class="n">tempest</span><span class="p">.</span><span class="n">tests</span><span class="p">.</span><span class="n">volume</span><span class="p">.</span><span class="n">test_volumes_list</span>
</pre></div>


<p>OR</p>
<div class="highlight"><pre><span class="n">nosetests</span> <span class="o">-</span><span class="n">sv</span> <span class="n">tempest</span><span class="p">.</span><span class="n">tests</span><span class="p">.</span><span class="n">volume</span><span class="p">.</span><span class="n">test_volumes_list</span><span class="p">.</span><span class="n">py</span>
</pre></div>


<p>To run a specific test <code>test_volume_list_with_details</code> from test class <code>VolumeListTest</code>, which resides in the above file:</p>
<div class="highlight"><pre>    <span class="n">nosetests</span> <span class="o">-</span><span class="n">sv</span> <span class="n">tempest</span><span class="p">.</span><span class="n">tests</span><span class="p">.</span><span class="n">volume</span><span class="p">.</span><span class="n">test_volumes_list</span><span class="o">:</span><span class="n">VolumeListTest</span><span class="p">.</span><span class="n">test_volume_list_with_details</span>
</pre></div>


<p>And that ladies and gentlemen, is the end! :)</p></div>
    <footer>
<p class="meta">
  <span class="byline author vcard">
    Posted by <span class="fn">Rushi Agrawal</span>
  </span>
<time datetime="2013-03-20T00:00:00" pubdate>Wed 20 March 2013</time>  <span class="categories">
    <a class="category" href="/tag/tech.html">tech</a>
    <a class="category" href="/tag/openstack.html">openstack</a>
    <a class="category" href="/tag/tempest.html">tempest</a>
    <a class="category" href="/tag/cloud.html">cloud</a>
    <a class="category" href="/tag/testing.html">testing</a>
    <a class="category" href="/tag/quickstart.html">quickstart</a>
    <a class="category" href="/tag/tutorial.html">tutorial</a>
  </span>
</p><div class="sharing">
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="/blog/2013/03/20/openstack-tempest-quick-start-with-devstack/" data-via="rushiagr" data-counturl="/blog/2013/03/20/openstack-tempest-quick-start-with-devstack/" >Tweet</a>
  <div class="g-plusone" data-size="medium"></div>
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
</div>    </footer>
  </article>

</div>
<aside class="sidebar">
  <section>
    <h1>Recent Posts</h1>
    <ul id="recent_posts">
      <li class="post">
          <a href="/blog/2015/12/12/better-way-to-view-mysql-tables/">Better way to view MySQL tables</a>
      </li>
      <li class="post">
          <a href="/blog/2015/09/14/quick-justdial-scraper/">Quick JustDial scraper</a>
      </li>
      <li class="post">
          <a href="/blog/2015/09/10/openstack-keystone-with-cassandra-database-in-devstack/">OpenStack Keystone with Cassandra Database in DevStack</a>
      </li>
      <li class="post">
          <a href="/blog/2015/07/24/apache-mod_wsgi-parallelization-notes/">Apache mod_wsgi parallelization notes</a>
      </li>
      <li class="post">
          <a href="/blog/2015/06/07/docker-quick-start-notes/">Docker quick start notes</a>
      </li>
    </ul>
  </section>
  <section>
      
    <h1>Categories</h1>
    <ul id="recent_posts">
        <li><a href="/category/tech.html">tech</a></li>
        <li><a href="/category/thoughts.html">thoughts</a></li>
    </ul>
  </section>
 

  <section>
  <h1>Tags</h1>
    <a href="/tag/operations.html">operations</a>,    <a href="/tag/.html"></a>,    <a href="/tag/quickstart.html">quickstart</a>,    <a href="/tag/nosql.html">nosql</a>,    <a href="/tag/storage.html">storage</a>,    <a href="/tag/squid.html">squid</a>,    <a href="/tag/scraper.html">scraper</a>,    <a href="/tag/apt.html">apt</a>,    <a href="/tag/vim.html">vim</a>,    <a href="/tag/packaging.html">packaging</a>,    <a href="/tag/puppet.html">puppet</a>,    <a href="/tag/ec2.html">ec2</a>,    <a href="/tag/mysql.html">mysql</a>,    <a href="/tag/openstack.html">openstack</a>,    <a href="/tag/quicstart.html">quicstart</a>,    <a href="/tag/technology.html">technology</a>,    <a href="/tag/tempest.html">tempest</a>,    <a href="/tag/cloud.html">cloud</a>,    <a href="/tag/cassandra.html">cassandra</a>,    <a href="/tag/block-storage.html">block-storage</a>,    <a href="/tag/git.html">git</a>,    <a href="/tag/cli.html">cli</a>,    <a href="/tag/iscsi.html">iscsi</a>,    <a href="/tag/cache.html">cache</a>,    <a href="/tag/distributed.html">distributed</a>,    <a href="/tag/devops.html">devops</a>,    <a href="/tag/terminal.html">terminal</a>,    <a href="/tag/cheatsheet.html">cheatsheet</a>,    <a href="/tag/systems.html">systems</a>,    <a href="/tag/keystone.html">keystone</a>,    <a href="/tag/screen.html">screen</a>,    <a href="/tag/tutorial.html">tutorial</a>,    <a href="/tag/openid.html">openid</a>,    <a href="/tag/testing.html">testing</a>,    <a href="/tag/nontech.html">nontech</a>,    <a href="/tag/python.html">python</a>,    <a href="/tag/commandline.html">commandline</a>,    <a href="/tag/aws.html">aws</a>,    <a href="/tag/scalability.html">scalability</a>,    <a href="/tag/automation.html">automation</a>,    <a href="/tag/amazon.html">amazon</a>,    <a href="/tag/lxc.html">lxc</a>,    <a href="/tag/milestone.html">milestone</a>,    <a href="/tag/apache.html">apache</a>,    <a href="/tag/devstack.html">devstack</a>,    <a href="/tag/data.html">data</a>,    <a href="/tag/linux.html">linux</a>,    <a href="/tag/github.html">github</a>,    <a href="/tag/boto.html">boto</a>,    <a href="/tag/notes.html">notes</a>,    <a href="/tag/server.html">server</a>,    <a href="/tag/tech.html">tech</a>,    <a href="/tag/containers.html">containers</a>,    <a href="/tag/databases.html">databases</a>,    <a href="/tag/lvm.html">lvm</a>,    <a href="/tag/cinder.html">cinder</a>,    <a href="/tag/docker.html">docker</a>,    <a href="/tag/ubuntu.html">ubuntu</a>,    <a href="/tag/virtualization.html">virtualization</a>  </section>



  <section>
    <h1>GitHub Repos</h1>
    <ul id="gh_repos">
      <li class="loading">Status updating...</li>
    </ul>
      <a href="https://github.com/rushiagr">@rushiagr</a> on GitHub
    <script type="text/javascript">
      $.domReady(function(){
          if (!window.jXHR){
              var jxhr = document.createElement('script');
              jxhr.type = 'text/javascript';
              jxhr.src = '/theme/js/jXHR.js';
              var s = document.getElementsByTagName('script')[0];
              s.parentNode.insertBefore(jxhr, s);
          }

          github.showRepos({
              user: 'rushiagr',
              count: 5,
              skip_forks: true,
              target: '#gh_repos'
          });
      });
    </script>
    <script src="/theme/js/github.js" type="text/javascript"> </script>
  </section>

    <section>
        <h1>Social</h1>
        <ul>
            <li><a href="http://rushiagr.github.io/feeds/all.rss.xml" type="application/rss+xml" rel="alternate">RSS</a></li>
            <li><a href="http://twitter.com/rushiagr" target="_blank">twitter</a></li>
            <li><a href="http://github.com/rushiagr" target="_blank">github</a></li>
        </ul>
    </section>

<section>
    <p>Follow <a href="http://twitter.com/rushiagr">@rushiagr</a></p>
</section>
</aside>    </div>
  </div>
  <footer role="contentinfo"><p>
    Copyright &copy;  2012-2015  - Rushi Agrawal -
  <span class="credit">Powered by <a href="http://getpelican.com">Pelican</a></span>
</p></footer>
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37074962-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-37074962-1');
    ga('send', 'pageview');
</script>
	<script type="text/javascript">
	  var disqus_shortname = 'rushiagr';
          var disqus_identifier = '/blog/2013/03/20/openstack-tempest-quick-start-with-devstack/';
          var disqus_url = '/blog/2013/03/20/openstack-tempest-quick-start-with-devstack/';
          var disqus_title = 'OpenStack Tempest quick start with DevStack';
	  (function() {
	    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
	    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	   })();
	</script>
  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>
  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
</body>
</html>